<IfModule mod_headers.c>

  # 1) HSTS – forza HTTPS (ATTENZIONE: solo se il sito è già sempre su HTTPS!)
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

  # 2) Content Security Policy (SEMPLIFICATA, ADATTATA AL TUO CASO)
  Header always set Content-Security-Policy "\
default-src 'self'; \
img-src 'self' data:; \
script-src 'self'; \
style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; \
font-src 'self' https://fonts.gstatic.com; \
connect-src 'self'; \
frame-ancestors 'self'; \
"

  # 3) COOP – isolamento tab
  Header always set Cross-Origin-Opener-Policy "same-origin"

  # 4) X-Frame-Options – contro clickjacking
  Header always set X-Frame-Options "SAMEORIGIN"

  # 5) Altri header utili
  Header always set X-Content-Type-Options "nosniff"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set X-XSS-Protection "0"

</IfModule>

